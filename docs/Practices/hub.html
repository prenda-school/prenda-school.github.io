<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Practices/hub/hub">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Working with Bounded Contexts in Hub | Prenda Engineering Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://prenda-school.github.io/docs/Practices/hub"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Working with Bounded Contexts in Hub | Prenda Engineering Documentation"><meta data-rh="true" name="description" content="Intro"><meta data-rh="true" property="og:description" content="Intro"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://prenda-school.github.io/docs/Practices/hub"><link data-rh="true" rel="alternate" href="https://prenda-school.github.io/docs/Practices/hub" hreflang="en"><link data-rh="true" rel="alternate" href="https://prenda-school.github.io/docs/Practices/hub" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Prenda Engineering Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Prenda Engineering Documentation Atom Feed"><link rel="stylesheet" href="/assets/css/styles.908d8d88.css">
<link rel="preload" href="/assets/js/runtime~main.3dd47e87.js" as="script">
<link rel="preload" href="/assets/js/main.0872d0bc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Prenda Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Prenda Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Prenda Engineering</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/introduction">How we engineer at Prenda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item example"><a class="menu__link" href="/docs/template">Template</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ArchitectureBoard">Architecture Board</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architecture Board&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/CriticalProcesses">Critical Processes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Critical Processes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Data/Masking/how-we-mask-data">Data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Policies/outages-and-calendar-policy">Policies</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Practices/how-we-engineer">Practices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Practices/how-we-engineer">Prenda: Engineering Team Principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Practices/npm">NPM best practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Practices/product-analytics">Product Analytics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/docs/Practices/hub">Working with Bounded Contexts in Hub</a><button aria-label="Toggle the collapsible sidebar category &#x27;Working with Bounded Contexts in Hub&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Practices/hub/examples">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Practices/hub/learning">Useful Abstractions</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Practices/staging">Staging</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/external-documentation">External Docs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Practices</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Working with Bounded Contexts in Hub</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Working with Bounded Contexts in Hub</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="intro">Intro<a href="#intro" class="hash-link" aria-label="Direct link to Intro" title="Direct link to Intro">​</a></h2><p>This document defines a number of guidelines to follow while working in Hub. Guidelines for working across projects can be found here (<em>not yet written</em>).</p><p>These guidelines are intended to lead an engineer towards achieving a set of goals outlined below. These guidelines are based around a set of <a href="/docs/glossary#useful-abstraction">useful abstractions</a> (UAs).</p><p>So what are some of the useful abstractions that we utilize? Some of the notable UAs are Domain Driven Design, Bounded Contexts, Command Query Separation, Verticle Slices Architecture, Functional styled Procedural Programming, Ports and Adapters, The Repository Pattern, and Onion (aka Clean aka Hexagonal) Architecture. Not all UAs are implemented dogmatically, and doing so would lead to many instances of conflict between the UAs. Rather choice core parts from different UAs have been chosen and applied in such a way that these parts are orthogonal to each other and support well the defined goals.</p><p>This document will not attempt to answer all critiques of a given guideline or UA nor will it discuss in depth the tradeoffs of why these guidelines and the associated UA(s) are the right tools.</p><p>For more on different UAs check out the <a href="/docs/Practices/hub/learning">learning doc</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="goals">Goals<a href="#goals" class="hash-link" aria-label="Direct link to Goals" title="Direct link to Goals">​</a></h2><ul><li>Code for a given capability is easy to find.</li><li>Changes to a given behavior are less risky.</li><li>The effects of a change to a domain model shape are clear and should cascade and only to those dependents that actually utilize the changes.</li><li>The API of code implementing a behavior is clear. <em>You should know exactly what data is required to successfully initiate a behavior as well as understanding the expected failures of that behavior</em></li><li>Failures due to essential complexity should be uniquely and easily identifiable and bad data states caused by such errors should be easily remediated.</li><li>Code should be covered by automated tests. <em>Testing strategy and acceptable coverage are not currently specified, but shoot for as much as possible.</em></li><li>Flexibility for implementation within defined boundaries. <em>Unlimited flexibility (autonomy) leads to multiple competing standards, analysis paralysis, lack of direction, and a lack of predictability in code. Inflexibility (too many conventions/only a single way to do something) leads to brittle code, overly complicated code for the purpose of adhering to defined rules, difficulty with corner cases. The sweet spot is one where there are multiple correct implementations that each can be derived from a set of UAs or guidelines. This provides confidence to an engineer because they are able to orient on a UA or guideline for direction while having to autonomy to being able to chart the appropriate course to get there.</em></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="non-goals">Non Goals<a href="#non-goals" class="hash-link" aria-label="Direct link to Non Goals" title="Direct link to Non Goals">​</a></h2><ul><li>Don&#x27;t Repeat Yourself (DRY) and Brevity at the expensive of clarity. <em>DRYness and Brevity are often associated with readability and understandability, but these should be seen as side effects of Clarity. If ever in doubt about a decision between dry/brevity and clarity, err on the side of clarity. Flexibility is also valuable given Prenda&#x27;s current state - history of many pivots and a future requiring pivoting and adaptability.</em></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guidelines">Guidelines<a href="#guidelines" class="hash-link" aria-label="Direct link to Guidelines" title="Direct link to Guidelines">​</a></h2><ul><li><p><a href="/docs/Practices/hub/learning#bounded-contexts">UA: Domain Driven Design - Bounded Contexts</a>, <a href="/docs/Practices/hub/learning#coupling-and-cohesion">UA: Coupling and Cohesion</a> Other than the consumption of a command or query, code sharing between bounded contexts should be avoided by default. There may be cases where a bounded context is implemented in a different project. In this case no dependency should be had on the code of that project and integration must be done asynchronously (http call, event handler, etc).</p></li><li><p><a href="/docs/Practices/hub/learning#vertical-slices">UA: Vertical Slices</a>, <a href="/docs/Practices/hub/learning#coupling-and-cohesion">UA: Coupling and Cohesion</a> The only dependencies between Vertical Slices (different command and queries) should be usages of the command or query function from another slice. Using shared code that sits outside the slice is fine. There are occasional exceptions to this rule, but it is preferred to err on the side of duplication by default. If you absolutely need to share code between slices, it should exist in a <code>shared</code> directory at the bounded context root. <em>Vertical Slices revolve around the axis of change being a slice. We want to couple along the axis of change. Sometimes we might be tempted to share code between two slices. One example would be needing to share some type, because two slices use a similar shape. An issue arises though when one slice is iterated on and needs to change that shape while another slice doesn&#x27;t. For this reason it would have been better to duplicate the shape between slices. A rule of thumb is if you plan to share code (type, function, constant, etc.), you need to be VERY sure it represents the exact same concept between slices. Sometimes shared code might actually fit best in an existing shared layer (repository, domain, data)</em></p></li><li><p><a href="/docs/Practices/hub/learning#bounded-contexts">UA: Domain Driven Design - Bounded Contexts</a>, <a href="/docs/Practices/hub/learning#cleanhexagonalonion-architecture">UA: Clean Architecture</a>, <a href="/docs/Practices/hub/learning#derived-types">UA: Derived Types</a>, <a href="/docs/Practices/hub/learning#coupling-and-cohesion">UA: Coupling and Cohesion</a> Base types representing the shape of domain models should be in the domain directory at the bounded context root. These types can be shared, often for the purpose of derivatives, among slices.</p></li><li><p><a href="/docs/Practices/hub/learning#bounded-contexts">UA: Domain Driven Design - Bounded Contexts</a>, <a href="/docs/Practices/hub/learning#cleanhexagonalonion-architecture">UA: Clean Architecture</a>, <a href="/docs/Practices/hub/learning#coupling-and-cohesion">UA: Coupling and Cohesion</a> Domain types, regardless of whether scoped to a slice or scoped to a bounded context, should not depend on code that is not itself either domain code or is a generic utility type (error handling, ts utils, and such). <em>This is a concept borrowed from Clean/Hexagonal/Onion architecture and key piece in the internal consistency of our domain model if followed. Exceptions to this rule should be very slim or non existent.</em></p></li><li><p><a href="/docs/Practices/hub/learning#cleanhexagonalonion-architecture">UA: Clean Architecture</a>, <a href="/docs/Practices/hub/learning#repository-pattern">UA: Repository pattern</a>, <a href="/docs/Practices/hub/learning#persistence-agnosticism">UA: Persistence Agnosticism</a> Repository layer code is the only code that should depend on types representing the shape of database table/view/query/etc. <em>The implementation details of data persistence should not be exposed to consumers of a domain model that utilizes said persistence. One of the quickest ways to building a ball of mud is to let a database schema (slow and risky to change) be the source of truth for the shape of a domain model across all layers and systems. There are cases where this is ok (constrained problem space, prototypes, etc), but this should be avoided by default.</em></p></li><li><p><a href="/docs/Practices/hub/learning#slim-apis-are-easier-to-maintain">UA: Slim APIs are Easier to Maintain</a> Don&#x27;t require more data for a function than is required. <em>A slim API is less risky to change and easier maintain and reason about.</em></p></li><li><p><a href="/docs/Practices/hub/learning#bounded-contexts">UA: Domain Driven Design - Bounded Contexts</a>, <a href="/docs/Practices/hub/learning#eventual-consistency">UA: Eventual Consistency</a> All data should only have a single source of truth. <em>It is ok for data to be stored in multiple places as long as the source of truth is always one location. For concepts that exist within multiple domains (students), it is perfectly acceptable for that concept to have its source of truth spread across data stores as long as no part (field) of any individual meaning is has its source of truth stored in more than one location.</em></p></li><li><p><a href="/docs/Practices/hub/learning#errors-as-values">UA: Errors as Values</a>, <a href="/docs/Practices/hub/learning#domain-modeling">UA: Domain Driven Design - Domain Modeling</a> The known errors of a command/query within a Vertical Slice should be included in its type signature. <em>It is recommended to coerce exceptions to values for known errors whenever possible, but at minimum no known errors should be exposed from a command/query function by way of thrown exception.</em></p></li><li><p><a href="/docs/Practices/hub/learning#domain-modeling">UA: Domain Driven Design - Domain Modeling</a> If an error represents a possible bad data state there should be documentation regarding this bad data state and how to remediate it. <em>At minimum there should be a comment attached to the type definition for a given error that provides appropriate context.</em></p></li><li><p><a href="/docs/Practices/hub/learning#testing">UA: Testing</a> When a bug is fixed an existing test should be updated to &quot;prove&quot; the fix or a new test should be written to accompany the fix.</p></li><li><p><a href="/docs/Practices/hub/learning#validatation">UA: Validation</a> Validation should be performed on all handler request data.</p><p>Validate for:</p><ul><li>Shape <em>correct fields in correct structure with correct spelling</em></li><li>Types <em>string, number, boolean, etc</em></li><li>Invariants <em>Rules to check for model consistency.</em><ul><li>One example is if property a is optional and if a is provided then b must be provided - but ONLY in the case of a being provided.</li><li>Another example is if a has the value &quot;X&quot; and b must be greater than 600 if a is &quot;X&quot; - then check for that.</li><li>Here is a video with an <a href="https://www.youtube.com/watch?v=64ngP-aUYPc&amp;t=131s" target="_blank" rel="noopener noreferrer">example</a> <em>90 sec watch</em> Just watch the invariant section of video.</li><li>Some invariants may be fine to be checked within the command itself. This will be the case for invariance checks that require additional work (such as fetching data) required to arrange the required data for a check. Invariance validation at the handler layer is mostly for being able to verify that the appropriate data required for valid attempt at command execution is present.</li></ul></li></ul></li><li><p><a href="/docs/Practices/hub/learning#bounded-contexts">UA: Domain Driven Design - Bounded Contexts</a> You should not reach into the database for another service. Other services should also not reach into Hub&#x27;s db. <em>As of Feb 3 2023, the other databases are the Enrollments db (postgres) and the Prendaworld db (mongo).</em></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="remediation-of-code-not-meeting-guidelines">Remediation of code not meeting guidelines<a href="#remediation-of-code-not-meeting-guidelines" class="hash-link" aria-label="Direct link to Remediation of code not meeting guidelines" title="Direct link to Remediation of code not meeting guidelines">​</a></h2><p>There are cases of existing code not meeting these existing guidelines. Refactoring existing code to meet these guidelines should be seen as tech debt and prioritized accordingly. Effort should be taken to have all new code meet these guidelines. </p><p>Any code that must break a guideline should be called out, addressed, and either documented for cases which make sense to break a guideline, or have an associated tech debt ticket created in cases where breaking a guideline is required to quickly remediate a critical issue that following a guideline would delay. <em>An example of this might be a critical bug that needs to be out ASAP. Maybe a fix was written and through existing automated tests + some manual testing + developer intuition it is determined that this fix works and won&#x27;t make the problem worse. In this case it is pragmatic to get this fix out even if it ignores the guideline for testing to prove a fix.</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conventions">Conventions<a href="#conventions" class="hash-link" aria-label="Direct link to Conventions" title="Direct link to Conventions">​</a></h2><p>Sometimes guidance that provides more specificity than a guideline needs to exist. </p><p>More often than not this is for enabling better implication. For example a naming convention allows engineers to draw better and more accurate conclusions without needing to review documentation.</p><p>Additionally guidelines might be library, framework, or project specific. Defining rules around how to interact with a library for example might be pragmatic if that library has capabilities that by some usages might conflict with existing guidelines.</p><p>For the purpose of this document, conventions should be seen as more specific guidelines or extensions to the guidelines.</p><p>Naming:</p><ul><li>The entrypoint function for a command or query should start with <code>command</code> or <code>query</code>.</li><li>The entrypoint function for a command or query should be in a file called <code>command.ts</code> or <code>query.ts</code> OR in a region called <code>Command</code> or <code>Query</code>.</li><li>Domain code should either be in files named appropriate to the model/process/rule/etc. within a <code>domain</code> directory, or be in a <code>domain.ts</code> file, or be in a region called <code>Domain</code>.</li><li>Legacy request handlers that are related to a bounded context and are expected to be maintained/iterated should be put in a <code>legacy-handlers</code> directory within the appropriate bounded context.</li><li>Integration code for 3rd party services should be in a <code>Data</code> directory.</li><li>Repository code (code that interacts with a data store), should be in a file called <code>repository.ts</code>, OR in a region called <code>Repository</code>.</li><li>(Request or Event) Handlers exposing a command should be in a file called <code>api.ts</code>, a region called <code>API</code>, or in files called <code>request.ts</code> or <code>event.ts</code> in a directory called <code>handlers</code>.</li><li>Integration code for bounded contexts in a different project should be in a <code>dependent-bcs</code> directory with sub directories matching the appropriate bounded context. <em>As of Jan 24 2023 this is not being utilized. Defining this early to reduce decision overhead when this occurs.</em></li><li>CRUD type functions that create new records in a single tab, fetch records by an unique id with no other filters from a single table, or mutate existing records without conditions from a single table, should reside in a directory called <code>crud-fns</code> within the shared <code>repository</code> directory.</li></ul><p><em><a href="/docs/Practices/hub/examples">Hub Directory Structure Example</a></em></p><p>Tests:</p><ul><li>Test files should sit close to the code they test. <em>Test files that test code in disparate files should be broken up into multiple test files itself.</em></li></ul><p>SQL:</p><ul><li>Avoid using the <a href="https://massivejs.org/docs/functions-and-scripts" target="_blank" rel="noopener noreferrer">massive scripts directory</a>. Prefer instead to define a query as close to its consumers as possible. <em>Defining queries in the scripts directory opens up the possibility of unintended coupling by non cohesive modules. There are solutions to syntax highlighting that don&#x27;t require a .sql file.</em></li></ul><p>Routing:</p><ul><li>Handlers should be wired up to routes in files within a directory called <code>routes</code> that is at the bounded context root. **</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-future">The Future<a href="#the-future" class="hash-link" aria-label="Direct link to The Future" title="Direct link to The Future">​</a></h2><ul><li><p>In the very near future it might make sense to refactor out shared repository shapes and functions in the Microschool Administration and Support Bounded Context to a layer that is shared between all bounded contexts. <em>It&#x27;s a fact that the lion&#x27;s share of data utilized by Hub is in one of the schemas in our postgres instance and utilizing a single shared repository model among all consumers within Hub might be the most pragmatic approach.</em></p></li><li><p>If and as we collect more data/it grows in complexity - we likely will need to apply the same decoupling of domains by way of bounded contexts to our databases. <em>We should condsider breaking up the database. Technical requirements and prudence should drive the implementation of breakup (schemas vs instances, etc). Each new distinct piece should relate to a given bounded context and should house ONLY the data required to support the Vertical Slices of those BCs.</em></p></li><li><p>A potential iteration to reduce coupling between slices in routing is to have each slice directory be able to define its own unique route while having a shared layer at the bounded context root then reference those definitions. There are many implementations that could achieve this. One could be to use nested routing where each slice/feature set (we don&#x27;t utilize feature sets yet) would define its own router and wire handlers and then the bounded context root would aggregate those routers underneath its own router. Another option is to have each slice define its own unique path constant and have bounded context root simply reference those constants while wiring. </p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="recommendations">Recommendations<a href="#recommendations" class="hash-link" aria-label="Direct link to Recommendations" title="Direct link to Recommendations">​</a></h2><p>These recommendations, while value adding, do not necessitate being a guideline and being subject to the remediation requirements of a guideline. They are worth understanding and applying as fit.</p><ul><li><p>Validate at all IO boundaries (guideline above indicates just handler request data). <em>Typescript can be a powerful tool, but it is only useful at compile time (as you write and build code). Validating that data being ingested by a process written using Typescript can go a long way in ensuring that the type safety provided by Typescript is reliable. Omitting validation at a boundary leaves room for undesirable behavior and sneaky errors (imagine getting &quot;cannot read property X of undefined&quot; when the type system supposedly doesn&#x27;t allow it)</em></p></li><li><p>Endeavour to make invalid states impossible. <a href="/docs/Practices/hub/examples#endeavour-to-make-invalid-states-impossible">Examples</a></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wiggle-room">Wiggle Room<a href="#wiggle-room" class="hash-link" aria-label="Direct link to Wiggle Room" title="Direct link to Wiggle Room">​</a></h2><p>This document doesn&#x27;t aim to define code styling (commands, linting rules, args as object vs not) nor does it aim to define the implementation of given abstractions as long as they don&#x27;t deviate from the guidelines. <em>For example you could have one Vertical Slice utilizing a driver to execute queries directly against a database through a connection while another Vertical Slice utilizes an ORM. As long as both slices don&#x27;t expose database concerns to the consumer of a given slice, then both strategies are acceptable. Another example would be tests. Maybe one slice tests itself by unit tests via isolated dependency and mocks + integration tests for side effects, while another test just uses api level integration (acceptance) testing. Both are acceptable as long as there is coverage.</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="contributing">Contributing<a href="#contributing" class="hash-link" aria-label="Direct link to Contributing" title="Direct link to Contributing">​</a></h2><p>TODO</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="process-to-change">Process to change<a href="#process-to-change" class="hash-link" aria-label="Direct link to Process to change" title="Direct link to Process to change">​</a></h3><p>TODO</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tips-for-changes">Tips for changes<a href="#tips-for-changes" class="hash-link" aria-label="Direct link to Tips for changes" title="Direct link to Tips for changes">​</a></h3><p>Guidelines:</p><ul><li>Make sure a guideline implements the intent of a <a href="/docs/glossary#useful-abstraction">UA</a> - whether it&#x27;s a new or existing one.</li><li>Try and be as flexible as possible. <em>For example the Guideline &quot;Don&#x27;t require more data for a function than is required.&quot; doesn&#x27;t actually specify whether a function should take an object with fields as a single argument or simply take multiple arguments. While there are arguments for both sides, it really doesn&#x27;t matter in the context of the guideline whether or not you take a single object vs multiple arguments.</em></li></ul><p>Conventions:</p><ul><li>Ask if a convention is really needed or not. Due to the specificity of conventions, a bad convention can end up causing more harm than benefit.</li><li>Does a convention support or extend (provide more context) to an existing guideline. If not, then does it support a goal or help bring clarity to a project? Would this simply be better as a some &quot;suggestion&quot; text in the project README or a discussion in slack/github/meeting?</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/prenda-school/prenda-school.github.io/tree/main/docs/Practices/hub/hub.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Practices/product-analytics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Product Analytics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Practices/hub/examples"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Examples</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intro" class="table-of-contents__link toc-highlight">Intro</a></li><li><a href="#goals" class="table-of-contents__link toc-highlight">Goals</a></li><li><a href="#non-goals" class="table-of-contents__link toc-highlight">Non Goals</a></li><li><a href="#guidelines" class="table-of-contents__link toc-highlight">Guidelines</a></li><li><a href="#remediation-of-code-not-meeting-guidelines" class="table-of-contents__link toc-highlight">Remediation of code not meeting guidelines</a></li><li><a href="#conventions" class="table-of-contents__link toc-highlight">Conventions</a></li><li><a href="#the-future" class="table-of-contents__link toc-highlight">The Future</a></li><li><a href="#recommendations" class="table-of-contents__link toc-highlight">Recommendations</a></li><li><a href="#wiggle-room" class="table-of-contents__link toc-highlight">Wiggle Room</a></li><li><a href="#contributing" class="table-of-contents__link toc-highlight">Contributing</a><ul><li><a href="#process-to-change" class="table-of-contents__link toc-highlight">Process to change</a></li><li><a href="#tips-for-changes" class="table-of-contents__link toc-highlight">Tips for changes</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Prenda</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3dd47e87.js"></script>
<script src="/assets/js/main.0872d0bc.js"></script>
</body>
</html>